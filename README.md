   # Warehouse API

   ## Описание
   Этот проект представляет собой RESTful API для управления складом рулонов металла. API позволяет добавлять, удалять, фильтровать и получать статистику по рулонам, а также поддерживает работу с базой данных PostgreSQL/SQLite и контейнеризацию с Docker.

   ## Стек технологий
   - **Язык**: Python 3.12
   - **Фреймворк**: FastAPI
   - **ORM**: SQLAlchemy (asyncio)
   - **База данных**: PostgreSQL/SQLite
   - **Миграции**: Alembic
   - **Кеширование**: Redis
   - **Тестирование**: pytest, pytest-asyncio
   - **Линтеры и форматирование**: flake8, black, mypy
   - **Контейнеризация**: Docker, Docker Compose

   ## Установка и запуск
   ### Локальный запуск
   1. Установите зависимости:
      ```sh
      poetry install
      ```
   2. Создайте и настройте файл `.env` (пример в `.env.example`).
   3. Запустите приложение:
      ```sh
      uvicorn app.main:app --reload
      ```

   ### Запуск через Docker
   1. Соберите и запустите контейнеры:
      ```sh
      docker compose -f infra/docker-compose.yaml up --build
      ```
   2. API будет доступен по адресу `http://localhost:8000`.
   3. Документация `http://localhost:8000/docs`.

   ## API Endpoints
   ### 1. Управление рулонами
   - **Добавление рулона** (POST `/rolls`): Добавляет рулон на склад.
   - **Получение рулонов** (GET `/rolls`): Получить информацию о рулонах с применением фильрации.
   - **Получение рулонов по ID** (GET `/rolls/{roll_id}`): Получить информацию о рулоне по его ID.
   - **Обновить данные рулона** (PATCH `/rolls/{roll_id}`): Обновить данные рулона.
   - **Удаление рулона** (DELETE `/rolls/{id}`): Удаляет рулон по `id`.
   - **Получение списка рулонов** (GET `/rolls`): Фильтрация по `id`, `весу`, `длине`, `дате добавления`, `дате удаления`.

   ### 2. Статистика по рулонам
   - **Получение статистики** (GET `/statistics`):
   - Количество добавленных и удалённых рулонов.
   - Средняя длина и вес рулонов.
   - Максимальная и минимальная длина и вес рулонов.
   - Суммарный вес рулонов.
   - Максимальный и минимальный промежуток хранения рулона.

   ## Конфигурация
   Настройки хранятся в `.env` и `config.py`. Основные параметры:
   - `DATABASE_URL`: строка подключения к БД.
   - `REDIS_URL`: строка подключения к Redis.
   - `DEBUG`: режим отладки.

   ## Тестирование
   1. Запуск тестов:
      ```sh
      pytest
      ```
   2. Проверка типов и стиля кода:
      ```sh
      mypy .
      flake8 .
      black --check .
      ```